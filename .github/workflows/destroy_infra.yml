{"payload":{"allShortcutsEnabled":false,"fileTree":{".github/workflows":{"items":[{"name":"backstage_deploy.yml","path":".github/workflows/backstage_deploy.yml","contentType":"file"},{"name":"destroy_infra.yml","path":".github/workflows/destroy_infra.yml","contentType":"file"},{"name":"hom_deploy.yml","path":".github/workflows/hom_deploy.yml","contentType":"file"},{"name":"prod_deploy.yml","path":".github/workflows/prod_deploy.yml","contentType":"file"}],"totalCount":4},".github":{"items":[{"name":"workflows","path":".github/workflows","contentType":"directory"}],"totalCount":1},"":{"items":[{"name":".github","path":".github","contentType":"directory"},{"name":".gitignore","path":".gitignore","contentType":"file"},{"name":"README.md","path":"README.md","contentType":"file"},{"name":"amazon-s3.yaml","path":"amazon-s3.yaml","contentType":"file"},{"name":"backend.tf","path":"backend.tf","contentType":"file"},{"name":"main.tf","path":"main.tf","contentType":"file"},{"name":"terraform.tfvars","path":"terraform.tfvars","contentType":"file"},{"name":"variables.tf","path":"variables.tf","contentType":"file"}],"totalCount":8}},"fileTreeProcessingTime":9.718411,"foldersToFetch":[],"reducedMotionEnabled":null,"repo":{"id":688165854,"defaultBranch":"main","name":"aws-s3-tf","ownerLogin":"pocacc","currentUserCanPush":false,"isFork":false,"isEmpty":false,"createdAt":"2023-09-06T19:35:13.000Z","ownerAvatar":"https://avatars.githubusercontent.com/u/143820254?v=4","public":true,"private":false,"isOrgOwned":true},"symbolsExpanded":false,"treeExpanded":true,"refInfo":{"name":"main","listCacheKey":"v0:1694202147.0","canEdit":false,"refType":"branch","currentOid":"78f2064fd50ffdacf123da5ad0725c7a33d749bd"},"path":".github/workflows/destroy_infra.yml","currentUser":null,"blob":{"rawLines":["name: \"destroy_infra\"","on:","  push:","    branches:","      - destroy","  pull_request:","permissions:","      id-token: write # This is required for aws oidc connection","      contents: read # This is required for actions/checkout","      pull-requests: write # This is required for gh bot to comment PR","env:","  TF_LOG: INFO","  AWS_REGION: ${{ secrets.AWS_REGION }}","jobs:","  destroy_infra:","    runs-on: ubuntu-latest","    defaults:","      run:","        shell: bash","        working-directory: .","    steps:","      - name: Git checkout","        uses: actions/checkout@v3","","      - name: Configure AWS credentials from AWS account","        uses: aws-actions/configure-aws-credentials@v1","        with:","          role-to-assume: ${{ secrets.AWS_ROLE }}","          aws-region: ${{ secrets.AWS_REGION }}","          role-session-name: ic-telefonica-openid-role","","      - name: Setup Terraform","        uses: hashicorp/setup-terraform@v2","        with:","          terraform_version: 1.2.5","","      - name: Terraform fmt","        id: fmt","        run: terraform fmt -check","        continue-on-error: true","","      - name: Terraform Init","        id: init","        env:","          AWS_BUCKET_NAME: ${{ secrets.AWS_BUCKET_NAME }}","          AWS_BUCKET_KEY_NAME: ${{ secrets.AWS_BUCKET_KEY_NAME }}","        run: terraform init -backend-config=\"bucket=${AWS_BUCKET_NAME}\" -backend-config=\"key=${AWS_BUCKET_KEY_NAME}\" -backend-config=\"region=${AWS_REGION}\"","","      - name: Terraform Validate","        id: validate","        run: terraform validate -no-color","","      - name: Terraform Plan","        id: plan","        run: terraform plan -no-color","        if: github.event_name == 'pull_request'","        continue-on-error: true","","      - uses: actions/github-script@v6","        if: github.event_name == 'pull_request'","        env:","          PLAN: \"terraform\\n${{ steps.plan.outputs.stdout }}\"","        with:","          github-token: ${{ secrets.GITHUB_TOKEN }}","          script: |","            const output = `#### Terraform Format and Style üñå\\`${{ steps.fmt.outcome }}\\`","            #### Terraform Initialization ‚öôÔ∏è\\`${{ steps.init.outcome }}\\`","            #### Terraform Validation ü§ñ\\`${{ steps.validate.outcome }}\\`","            <details><summary>Validation Output</summary>","","            \\`\\`\\`\\n","            ${{ steps.validate.outputs.stdout }}","            \\`\\`\\`","","            </details>","","            #### Terraform Plan üìñ\\`${{ steps.plan.outcome }}\\`","","            <details><summary>Show Plan</summary>","","            \\`\\`\\`\\n","            ${process.env.PLAN}","            \\`\\`\\`","","            </details>","","            *Pushed by: @${{ github.actor }}, Action: \\`${{ github.event_name }}\\`*`;","","            github.rest.issues.createComment({","              issue_number: context.issue.number,","              owner: context.repo.owner,","              repo: context.repo.repo,","              body: output","            })","","      - name: Terraform Plan Status","        if: steps.plan.outcome == 'failure'","        run: exit 1","","      - name: Terraform destroy","        if: github.ref == 'refs/heads/destroy' && github.event_name == 'push'","        run: terraform destroy -auto-approve -input=true"],"stylingDirectives":[[{"start":0,"end":4,"cssClass":"pl-ent"},{"start":6,"end":21,"cssClass":"pl-s"},{"start":6,"end":7,"cssClass":"pl-pds"},{"start":20,"end":21,"cssClass":"pl-pds"}],[{"start":0,"end":2,"cssClass":"pl-ent"}],[{"start":2,"end":6,"cssClass":"pl-ent"}],[{"start":4,"end":12,"cssClass":"pl-ent"}],[{"start":8,"end":15,"cssClass":"pl-s"}],[{"start":2,"end":14,"cssClass":"pl-ent"}],[{"start":0,"end":11,"cssClass":"pl-ent"}],[{"start":6,"end":14,"cssClass":"pl-ent"},{"start":16,"end":22,"cssClass":"pl-s"},{"start":22,"end":64,"cssClass":"pl-c"},{"start":22,"end":23,"cssClass":"pl-c"}],[{"start":6,"end":14,"cssClass":"pl-ent"},{"start":16,"end":21,"cssClass":"pl-s"},{"start":21,"end":60,"cssClass":"pl-c"},{"start":21,"end":22,"cssClass":"pl-c"}],[{"start":6,"end":19,"cssClass":"pl-ent"},{"start":21,"end":27,"cssClass":"pl-s"},{"start":27,"end":70,"cssClass":"pl-c"},{"start":27,"end":28,"cssClass":"pl-c"}],[{"start":0,"end":3,"cssClass":"pl-ent"}],[{"start":2,"end":8,"cssClass":"pl-ent"},{"start":10,"end":14,"cssClass":"pl-s"}],[{"start":2,"end":12,"cssClass":"pl-ent"},{"start":14,"end":39,"cssClass":"pl-s"}],[{"start":0,"end":4,"cssClass":"pl-ent"}],[{"start":2,"end":15,"cssClass":"pl-ent"}],[{"start":4,"end":11,"cssClass":"pl-ent"},{"start":13,"end":26,"cssClass":"pl-s"}],[{"start":4,"end":12,"cssClass":"pl-ent"}],[{"start":6,"end":9,"cssClass":"pl-ent"}],[{"start":8,"end":13,"cssClass":"pl-ent"},{"start":15,"end":19,"cssClass":"pl-s"}],[{"start":8,"end":25,"cssClass":"pl-ent"},{"start":27,"end":28,"cssClass":"pl-s"}],[{"start":4,"end":9,"cssClass":"pl-ent"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":26,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":33,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":56,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":54,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":24,"cssClass":"pl-ent"},{"start":26,"end":49,"cssClass":"pl-s"}],[{"start":10,"end":20,"cssClass":"pl-ent"},{"start":22,"end":47,"cssClass":"pl-s"}],[{"start":10,"end":27,"cssClass":"pl-ent"},{"start":29,"end":54,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":29,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":42,"cssClass":"pl-s"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":27,"cssClass":"pl-ent"},{"start":29,"end":34,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":27,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":15,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":33,"cssClass":"pl-s"}],[{"start":8,"end":25,"cssClass":"pl-ent"},{"start":27,"end":31,"cssClass":"pl-c1"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":28,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":16,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"}],[{"start":10,"end":25,"cssClass":"pl-ent"},{"start":27,"end":57,"cssClass":"pl-s"}],[{"start":10,"end":29,"cssClass":"pl-ent"},{"start":31,"end":65,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":155,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":32,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":20,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":41,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":28,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":16,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":37,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":47,"cssClass":"pl-s"}],[{"start":8,"end":25,"cssClass":"pl-ent"},{"start":27,"end":31,"cssClass":"pl-c1"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":38,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":47,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"}],[{"start":10,"end":14,"cssClass":"pl-ent"},{"start":16,"end":61,"cssClass":"pl-s"},{"start":16,"end":17,"cssClass":"pl-pds"},{"start":26,"end":28,"cssClass":"pl-cce"},{"start":60,"end":61,"cssClass":"pl-pds"}],[{"start":8,"end":12,"cssClass":"pl-ent"}],[{"start":10,"end":22,"cssClass":"pl-ent"},{"start":24,"end":51,"cssClass":"pl-s"}],[{"start":10,"end":16,"cssClass":"pl-ent"},{"start":18,"end":19,"cssClass":"pl-s"}],[{"start":0,"end":90,"cssClass":"pl-s"}],[{"start":0,"end":73,"cssClass":"pl-s"}],[{"start":0,"end":73,"cssClass":"pl-s"}],[{"start":0,"end":57,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":20,"cssClass":"pl-s"}],[{"start":0,"end":48,"cssClass":"pl-s"}],[{"start":0,"end":18,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":22,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":63,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":49,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":20,"cssClass":"pl-s"}],[{"start":0,"end":31,"cssClass":"pl-s"}],[{"start":0,"end":18,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":22,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":85,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":46,"cssClass":"pl-s"}],[{"start":0,"end":49,"cssClass":"pl-s"}],[{"start":0,"end":40,"cssClass":"pl-s"}],[{"start":0,"end":38,"cssClass":"pl-s"}],[{"start":0,"end":26,"cssClass":"pl-s"}],[{"start":0,"end":14,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"}],[{"start":0,"end":0,"cssClass":"pl-s"},{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":35,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":43,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":19,"cssClass":"pl-s"}],[],[{"start":8,"end":12,"cssClass":"pl-ent"},{"start":14,"end":31,"cssClass":"pl-s"}],[{"start":8,"end":10,"cssClass":"pl-ent"},{"start":12,"end":77,"cssClass":"pl-s"}],[{"start":8,"end":11,"cssClass":"pl-ent"},{"start":13,"end":56,"cssClass":"pl-s"}]],"csv":null,"csvError":null,"dependabotInfo":{"showConfigurationBanner":false,"configFilePath":null,"networkDependabotPath":"/pocacc/aws-s3-tf/network/updates","dismissConfigurationNoticePath":"/settings/dismiss-notice/dependabot_configuration_notice","configurationNoticeDismissed":null,"repoAlertsPath":"/pocacc/aws-s3-tf/security/dependabot","repoSecurityAndAnalysisPath":"/pocacc/aws-s3-tf/settings/security_analysis","repoOwnerIsOrg":true,"currentUserCanAdminRepo":false},"displayName":"destroy_infra.yml","displayUrl":"https://github.com/pocacc/aws-s3-tf/blob/main/.github/workflows/destroy_infra.yml?raw=true","headerInfo":{"blobSize":"3.05 KB","deleteInfo":{"deleteTooltip":"You must be signed in to make or propose changes"},"editInfo":{"editTooltip":"You must be signed in to make or propose changes"},"ghDesktopPath":"https://desktop.github.com","gitLfsPath":null,"onBranch":true,"shortPath":"190d19a","siteNavLoginPath":"/login?return_to=https%3A%2F%2Fgithub.com%2Fpocacc%2Faws-s3-tf%2Fblob%2Fmain%2F.github%2Fworkflows%2Fdestroy_infra.yml","isCSV":false,"isRichtext":false,"toc":null,"lineInfo":{"truncatedLoc":"102","truncatedSloc":"85"},"mode":"file"},"image":false,"isCodeownersFile":null,"isPlain":false,"isValidLegacyIssueTemplate":false,"issueTemplateHelpUrl":"https://docs.github.com/articles/about-issue-and-pull-request-templates","issueTemplate":null,"discussionTemplate":null,"language":"YAML","languageID":407,"large":false,"loggedIn":false,"newDiscussionPath":"/pocacc/aws-s3-tf/discussions/new","newIssuePath":"/pocacc/aws-s3-tf/issues/new","planSupportInfo":{"repoIsFork":null,"repoOwnedByCurrentUser":null,"requestFullPath":"/pocacc/aws-s3-tf/blob/main/.github/workflows/destroy_infra.yml","showFreeOrgGatedFeatureMessage":null,"showPlanSupportBanner":null,"upgradeDataAttributes":null,"upgradePath":null},"publishBannersInfo":{"dismissActionNoticePath":"/settings/dismiss-notice/publish_action_from_dockerfile","dismissStackNoticePath":"/settings/dismiss-notice/publish_stack_from_file","releasePath":"/pocacc/aws-s3-tf/releases/new?marketplace=true","showPublishActionBanner":false,"showPublishStackBanner":false},"renderImageOrRaw":false,"richText":null,"renderedFileInfo":null,"shortPath":null,"tabSize":8,"topBannersInfo":{"overridingGlobalFundingFile":false,"globalPreferredFundingPath":null,"repoOwner":"pocacc","repoName":"aws-s3-tf","showInvalidCitationWarning":false,"citationHelpUrl":"https://docs.github.com/en/github/creating-cloning-and-archiving-repositories/creating-a-repository-on-github/about-citation-files","showDependabotConfigurationBanner":false,"actionsOnboardingTip":null},"truncated":false,"viewable":true,"workflowRedirectUrl":"/pocacc/aws-s3-tf/actions/workflows/destroy_infra.yml","symbols":{"timedOut":false,"notAnalyzed":true,"symbols":[]}},"copilotInfo":null,"csrf_tokens":{"/pocacc/aws-s3-tf/branches":{"post":"dupE-rBMNPbdMlklQT2Gre3HA_scorc5u20TtKmTtsIorLMTac0m-T3qK_H5aBPpCaejHYIiZVcF-kWew17C-A"},"/repos/preferences":{"post":"b9dc8d5engBpDMUBpWo_Gs8cSYoDHXNz9FisjVKRa1YP_6LaPFtOd_RvfYVl_HKBTTHAe0o8z3doZnWJdsu6XQ"}}},"title":"aws-s3-tf/.github/workflows/destroy_infra.yml at main ¬∑ pocacc/aws-s3-tf"}